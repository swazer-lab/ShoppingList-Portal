(function(n,t){var i={after:["attr","value"],defaults:{plugins:["textcolor advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste"],toolbar:"undo redo | styleselect | bold italic underline | link image imageupload | forecolor backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent |",menubar:"edit insert view format table tools help",automatic_uploads:!1,image_description:!1,file_browser_callback_types:"image",file_picker_types:"image",images_upload_url:"postAcceptor.php",init_instance_callback:function(n){n.execCommand("mceImage")},paste_data_images:!0,images_upload_handler:function(n,t){var r=n.blob(),i=new FileReader;i.onload=function(){t(i.result)};i.readAsDataURL(r)},max_chars:9999,tinymce_updateCharCounter:function(t,i){n("#"+t.id).prev().find(".char_count").text(i+"/"+t.settings.max_chars)},tinymce_getContentLength:function(){return tinymce.get(tinymce.activeEditor.id).contentDocument.body.innerText.length},setup:function(n){n.on("init",function(){var t=n.id;document.getElementById(t+"_ifr").style.height="300px"});var t=[8,37,38,39,40,46];n.on("keydown",function(n){return t.indexOf(n.keyCode)!=-1?!0:this.settings.tinymce_getContentLength()+1>this.settings.max_chars?(n.preventDefault(),n.stopPropagation(),!1):!0});n.on("keyup",function(){this.settings.tinymce_updateCharCounter(this,this.settings.tinymce_getContentLength())})},init_instance_callback:function(){n("#"+this.id).prev().append('<div><span style="margin-top:3px;" class="char_count pull-left flip"><\/span><\/div>');this.settings.tinymce_updateCharCounter(this,this.settings.tinymce_getContentLength())},paste_preprocess:function(n,t){var i=tinymce.get(tinymce.activeEditor.id),r=i.contentDocument.body.innerText.length,u=t.content;r+u.length>i.settings.max_chars?(alert("Pasting this exceeds the maximum allowed number of "+i.settings.max_chars+" characters."),t.content=""):i.settings.tinymce_updateCharCounter(i,r+u.length)}},extensions:{},init:function(u,f,e){if(!t.isWriteableObservable(f()))throw"valueAccessor must be writeable and observable";var o=e.has("wysiwygConfig")?e.get("wysiwygConfig"):null,s=e.has("wysiwygExtensions")?e.get("wysiwygExtensions"):[],h=r(i.defaults,s,o,arguments);return n(u).text(f()()),setTimeout(function(){n(u).tinymce(h)},0),t.utils.domNodeDisposal.addDisposeCallback(u,function(){n(u).tinymce().remove()}),{controlsDescendantBindings:!0}},update:function(i,r){var u=n(i).tinymce(),e=r()(),f,o;u&&u.getContent()!==e&&(u.setContent(e),u.execCommand("keyup"),f=t.bindingHandlers.wysiwyg.defaults,o=f.tinymce_getContentLength(),f.tinymce_updateCharCounter(u,o))}},r=function(r,u,f,e){var o=n.extend(!0,{},r),s,h;return f&&(t.utils.objectForEach(f,function(n){Object.prototype.toString.call(f[n])==="[object Array]"&&(o[n]||(o[n]=[]),f[n]=t.utils.arrayGetDistinctValues(o[n].concat(f[n])))}),n.extend(!0,o,f)),o.plugins?n.inArray("paste",o.plugins)===-1&&o.plugins.push("paste"):o.plugins=["paste"],s=function(n){n.on("change keyup nodechange",function(t){e[1]()(n.getContent());for(var r in u)u.hasOwnProperty(r)&&i.extensions[u[r]](n,t,e[2],e[4])})},typeof o.setup=="function"?(h=o.setup,o.setup=function(n){h(n);s(n)}):o.setup=s,o};t.bindingHandlers.wysiwyg=i})(jQuery,ko);